# Процесс загрузки данных
Процесс загрузки данных начинается в предварительно оговоренное время, осуществляется через промежуточную базу и состоит из таких шагов:

1. Выгрузка из базы данных за два месяца по всем складам для контрольной сверки. 
2. Загрузка данных из базы клиента в промежуточную базу. Схема базы данных описана ниже.
3. После подгрузки данных в промежуточною базу, специалистам клиента необходимо заполнить таблицы **CustomerDocSum** и **SupplierDocSum**, где будут суммироваться данные за день. Это необходимо для проверки данных после загрузки на сервис.

**CustomerDocSum** - таблица для проверки данных
* storage_id*  (int | varchar) - ID склада
* date* (date) - дата 
* document_type_id* (int | varchar) тип документов с клиентами
* documents_qty* (decimal) - количество документов
* total_price* (decimal) - общая сумма
* qty* (decimal) - количество товара
* profit* (decimal) - прибыль
 
**SupplierDocSum** - таблица для проверки данных
* storage_id*  (int | varchar) - ID склада
* date* (date) - дата 
* document_type_id* (int | varchar) - тип документов с поставщиками
* documents_qty* (decimal) - количество документов
* total_price* (decimal) - общая сумма 
* qty* (decimal) - количество товара

4. После загрузки данных в промежуточную базу, начинается процесс загрузки данных в базу сервиса.
5. Во время этой загрузки происходит процесс валидации данных. 
6. Во всех справочниках для загруженных объектов значение поля changed = 1 меняем на 0 и обекты с значение поля changed = 2 удаляются . 
7. После загрузки данных из промежуточной базы, специалисты сверяют данные с  таблицами **CustomerDocSum** и **SupplierDocSum**.

Более подробно техническое задание для загрузки данных дистрибьюторов описано по ссылке: [Описание промежуточной базы данных](https://docs.google.com/document/d/1J9WPjssjSPuU3qmaZY16_wUd05Vckmuse5XqA1LObKE/edit#heading=h.3af6emd5fgq)
